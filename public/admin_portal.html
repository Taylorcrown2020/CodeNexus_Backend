<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CraftedCode Co. | CRM Portal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
:root{--bg-primary:#0a0a0b;--bg-secondary:#111113;--bg-tertiary:#18181b;--bg-hover:#27272a;--border-subtle:rgba(255,255,255,.06);--border-default:rgba(255,255,255,.1);--border-strong:rgba(255,255,255,.15);--text-primary:#fafafa;--text-secondary:#a1a1aa;--text-muted:#71717a;--text-faint:#52525b;--accent-primary:#10b981;--accent-primary-dim:rgba(16,185,129,.15);--accent-secondary:#3b82f6;--accent-secondary-dim:rgba(59,130,246,.15);--status-new:#3b82f6;--status-pending:#f59e0b;--status-contacted:#10b981;--status-closed:#8b5cf6;--status-lost:#ef4444;--priority-high:#ef4444;--priority-medium:#f59e0b;--priority-low:#71717a;--font-display:'Plus Jakarta Sans',-apple-system,sans-serif;--font-mono:'JetBrains Mono',monospace;--radius-sm:6px;--radius-md:8px;--radius-lg:12px;--radius-xl:16px;--shadow-lg:0 8px 24px rgba(0,0,0,.6);--sidebar-width:260px}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:var(--font-display);background:var(--bg-primary);color:var(--text-primary);line-height:1.6;min-height:100vh}
::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--border-strong);border-radius:3px}
.sidebar{position:fixed;left:0;top:0;width:var(--sidebar-width);height:100vh;background:var(--bg-secondary);border-right:1px solid var(--border-subtle);display:flex;flex-direction:column;z-index:100}
.sidebar-header{padding:24px;border-bottom:1px solid var(--border-subtle)}.logo{display:flex;align-items:center;gap:12px}
.logo-mark{width:36px;height:36px;background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));border-radius:var(--radius-md);display:flex;align-items:center;justify-content:center;font-family:var(--font-mono);font-weight:700;font-size:14px;color:var(--bg-primary)}
.logo-text{font-weight:700;font-size:16px;letter-spacing:-.02em}.logo-text span{color:var(--text-muted);font-weight:500}
.sidebar-nav{flex:1;padding:16px 12px;overflow-y:auto}.nav-section{margin-bottom:24px}
.nav-section-title{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--text-faint);padding:0 12px;margin-bottom:8px}
.nav-item{display:flex;align-items:center;gap:12px;padding:10px 12px;border-radius:var(--radius-md);cursor:pointer;transition:all .15s ease;color:var(--text-secondary);font-size:14px;font-weight:500;position:relative}
.nav-item:hover{background:var(--bg-hover);color:var(--text-primary)}.nav-item.active{background:var(--accent-primary-dim);color:var(--accent-primary)}
.nav-item.active::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:3px;height:20px;background:var(--accent-primary);border-radius:0 2px 2px 0}
.nav-icon{width:18px;height:18px;opacity:.7}.nav-item.active .nav-icon{opacity:1}
.nav-badge{margin-left:auto;background:var(--accent-primary);color:var(--bg-primary);font-size:10px;font-weight:700;padding:2px 6px;border-radius:10px;min-width:18px;text-align:center}
.sidebar-footer{padding:16px;border-top:1px solid var(--border-subtle)}
.user-card{display:flex;align-items:center;gap:12px;padding:12px;background:var(--bg-tertiary);border-radius:var(--radius-md);cursor:pointer;transition:all .15s ease}
.user-card:hover{background:var(--bg-hover)}.user-avatar{width:36px;height:36px;background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:13px;color:var(--bg-primary)}
.user-info{flex:1;min-width:0}.user-name{font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.user-role{font-size:11px;color:var(--text-muted)}
.main-content{margin-left:var(--sidebar-width);min-height:100vh;background:var(--bg-primary)}
.topbar{position:sticky;top:0;height:72px;background:rgba(10,10,11,.8);backdrop-filter:blur(12px);border-bottom:1px solid var(--border-subtle);display:flex;align-items:center;justify-content:space-between;padding:0 32px;z-index:50}
.page-title{font-size:20px;font-weight:700;letter-spacing:-.02em}.page-title::before{content:'//';color:var(--accent-primary);margin-right:8px;font-family:var(--font-mono)}
.topbar-actions{display:flex;align-items:center;gap:12px}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 16px;border-radius:var(--radius-md);font-size:13px;font-weight:600;font-family:inherit;cursor:pointer;transition:all .15s ease;border:none;white-space:nowrap}
.btn svg{width:16px;height:16px}.btn-primary{background:var(--accent-primary);color:var(--bg-primary)}.btn-primary:hover{background:#0ea572;box-shadow:0 4px 12px rgba(16,185,129,.3)}
.btn-secondary{background:var(--bg-tertiary);color:var(--text-primary);border:1px solid var(--border-default)}.btn-secondary:hover{background:var(--bg-hover);border-color:var(--border-strong)}
.btn-danger{background:rgba(239,68,68,.1);color:var(--status-lost);border:1px solid rgba(239,68,68,.2)}.btn-danger:hover{background:var(--status-lost);color:#fff}
.content{padding:32px}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:32px}
.stat-card{background:var(--bg-secondary);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);padding:20px;transition:all .2s ease}
.stat-card:hover{border-color:var(--border-default);transform:translateY(-2px)}.stat-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.stat-label{font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted)}
.stat-icon{width:32px;height:32px;border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center}.stat-icon svg{width:16px;height:16px}
.stat-icon.blue{background:var(--accent-secondary-dim);color:var(--accent-secondary)}.stat-icon.amber{background:rgba(245,158,11,.15);color:var(--status-pending)}
.stat-icon.green{background:var(--accent-primary-dim);color:var(--accent-primary)}.stat-icon.purple{background:rgba(139,92,246,.15);color:var(--status-closed)}
.stat-value{font-size:32px;font-weight:800;letter-spacing:-.02em;font-family:var(--font-mono)}.stat-change{display:flex;align-items:center;gap:4px;font-size:12px;margin-top:8px;color:var(--text-muted)}.stat-change.positive{color:var(--accent-primary)}
.controls-bar{display:flex;align-items:center;gap:16px;margin-bottom:24px;flex-wrap:wrap}.search-box{flex:1;min-width:280px;position:relative}
.search-input{width:100%;padding:10px 16px 10px 40px;background:var(--bg-secondary);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-size:13px;font-family:inherit;transition:all .15s ease}
.search-input:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px var(--accent-primary-dim)}.search-input::placeholder{color:var(--text-muted)}
.search-icon{position:absolute;left:14px;top:50%;transform:translateY(-50%);color:var(--text-muted);width:16px;height:16px}
.filter-group{display:flex;gap:4px;background:var(--bg-secondary);padding:4px;border-radius:var(--radius-md);border:1px solid var(--border-subtle)}
.filter-btn{padding:8px 14px;background:transparent;border:none;border-radius:var(--radius-sm);color:var(--text-secondary);font-size:12px;font-weight:600;font-family:inherit;cursor:pointer;transition:all .15s ease}
.filter-btn:hover{color:var(--text-primary);background:var(--bg-hover)}.filter-btn.active{background:var(--accent-primary);color:var(--bg-primary)}
.table-container{background:var(--bg-secondary);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);overflow:hidden}
.data-table{width:100%;border-collapse:collapse}.data-table thead{background:var(--bg-tertiary)}
.data-table th{padding:12px 16px;text-align:left;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted);border-bottom:1px solid var(--border-subtle);white-space:nowrap}
.data-table td{padding:14px 16px;font-size:13px;color:var(--text-secondary);border-bottom:1px solid var(--border-subtle);vertical-align:middle}
.data-table tbody tr{transition:background .15s ease;cursor:pointer}.data-table tbody tr:hover{background:var(--bg-hover)}.data-table tbody tr:last-child td{border-bottom:none}
.contact-cell{display:flex;align-items:center;gap:12px}.contact-avatar{width:32px;height:32px;border-radius:var(--radius-sm);background:var(--bg-hover);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:var(--text-muted);flex-shrink:0}
.contact-info{min-width:0}.contact-name{font-weight:600;color:var(--text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.contact-email{font-size:12px;color:var(--text-muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.status-badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.02em}
.status-dot{width:6px;height:6px;border-radius:50%}
.status-new{background:rgba(59,130,246,.1);color:var(--status-new)}.status-new .status-dot{background:var(--status-new)}
.status-pending{background:rgba(245,158,11,.1);color:var(--status-pending)}.status-pending .status-dot{background:var(--status-pending)}
.status-contacted{background:rgba(16,185,129,.1);color:var(--status-contacted)}.status-contacted .status-dot{background:var(--status-contacted)}
.status-closed{background:rgba(139,92,246,.1);color:var(--status-closed)}.status-closed .status-dot{background:var(--status-closed)}
.status-lost,.status-churned,.status-cancelled{background:rgba(239,68,68,.1);color:var(--status-lost)}.status-lost .status-dot,.status-churned .status-dot,.status-cancelled .status-dot{background:var(--status-lost)}
.status-onboarding{background:rgba(6,182,212,.1);color:#06b6d4}.status-onboarding .status-dot{background:#06b6d4}
.status-in-progress{background:rgba(59,130,246,.1);color:var(--status-new)}.status-in-progress .status-dot{background:var(--status-new)}
.status-review{background:rgba(245,158,11,.1);color:var(--status-pending)}.status-review .status-dot{background:var(--status-pending)}
.status-completed{background:rgba(16,185,129,.1);color:var(--status-contacted)}.status-completed .status-dot{background:var(--status-contacted)}
.status-on-hold{background:rgba(113,113,122,.1);color:var(--text-muted)}.status-on-hold .status-dot{background:var(--text-muted)}
.priority-badge{display:inline-flex;align-items:center;gap:4px;padding:3px 8px;border-radius:var(--radius-sm);font-size:11px;font-weight:600}
.priority-high{background:rgba(239,68,68,.1);color:var(--priority-high)}.priority-medium{background:rgba(245,158,11,.1);color:var(--priority-medium)}.priority-low{background:rgba(113,113,122,.1);color:var(--priority-low)}
.table-actions{display:flex;gap:4px}.table-action-btn{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:transparent;border:1px solid var(--border-subtle);border-radius:var(--radius-sm);color:var(--text-muted);cursor:pointer;transition:all .15s ease}
.table-action-btn:hover{background:var(--bg-hover);border-color:var(--border-default);color:var(--text-primary)}.table-action-btn.danger:hover{background:rgba(239,68,68,.1);border-color:var(--status-lost);color:var(--status-lost)}.table-action-btn svg{width:14px;height:14px}
.table-footer{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-top:1px solid var(--border-subtle);background:var(--bg-tertiary)}.table-info{font-size:13px;color:var(--text-muted)}
.empty-state{padding:60px 20px;text-align:center}.empty-icon{width:48px;height:48px;margin:0 auto 16px;color:var(--text-faint)}.empty-title{font-size:16px;font-weight:600;color:var(--text-secondary);margin-bottom:8px}.empty-description{font-size:13px;color:var(--text-muted);max-width:300px;margin:0 auto}
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(4px);z-index:200;align-items:flex-start;justify-content:center;padding:40px 20px;overflow-y:auto}
.modal-overlay.active{display:flex}.modal{background:var(--bg-secondary);border:1px solid var(--border-subtle);border-radius:var(--radius-xl);width:100%;max-width:720px;box-shadow:var(--shadow-lg);animation:modalSlide .2s ease}
@keyframes modalSlide{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
.modal-header{display:flex;align-items:center;justify-content:space-between;padding:20px 24px;border-bottom:1px solid var(--border-subtle)}.modal-title{font-size:18px;font-weight:700;letter-spacing:-.01em}
.modal-close{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:var(--bg-hover);border:none;border-radius:var(--radius-sm);color:var(--text-secondary);cursor:pointer;transition:all .15s ease}.modal-close:hover{background:var(--bg-tertiary);color:var(--text-primary)}
.modal-body{padding:24px}.modal-footer{display:flex;align-items:center;justify-content:flex-end;gap:12px;padding:16px 24px;border-top:1px solid var(--border-subtle);background:var(--bg-tertiary);border-radius:0 0 var(--radius-xl) var(--radius-xl)}
.form-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px}.form-group{display:flex;flex-direction:column;gap:6px}.form-group.full-width{grid-column:1/-1}
.form-label{font-size:12px;font-weight:600;color:var(--text-secondary)}.form-label .required{color:var(--status-lost)}
.form-input,.form-select,.form-textarea{padding:10px 12px;background:var(--bg-tertiary);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-size:13px;font-family:inherit;transition:all .15s ease}
.form-input:focus,.form-select:focus,.form-textarea:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px var(--accent-primary-dim)}.form-input::placeholder,.form-textarea::placeholder{color:var(--text-muted)}.form-select{cursor:pointer}.form-textarea{min-height:100px;resize:vertical}
.detail-section{margin-bottom:24px}.section-header{display:flex;align-items:center;gap:8px;margin-bottom:16px;padding-bottom:8px;border-bottom:1px solid var(--border-subtle)}
.section-title{font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted)}
.detail-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}.detail-item{background:var(--bg-tertiary);padding:12px;border-radius:var(--radius-md);border:1px solid var(--border-subtle)}.detail-item.full-width{grid-column:1/-1}
.detail-label{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted);margin-bottom:4px}.detail-value{font-size:13px;color:var(--text-primary);word-break:break-word}
.notes-list{display:flex;flex-direction:column;gap:12px;margin-bottom:16px;max-height:300px;overflow-y:auto}
.note-item{background:var(--bg-tertiary);border:1px solid var(--border-subtle);border-left:3px solid var(--accent-primary);border-radius:var(--radius-md);padding:12px}
.note-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}.note-author{font-size:12px;font-weight:600;color:var(--text-secondary)}.note-date{font-size:11px;color:var(--text-muted);font-family:var(--font-mono)}.note-text{font-size:13px;color:var(--text-primary);line-height:1.6}.note-empty{text-align:center;padding:24px;color:var(--text-muted);font-size:13px}
.cards-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}
.employee-card{background:var(--bg-secondary);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);padding:20px;transition:all .2s ease}.employee-card:hover{border-color:var(--border-default);transform:translateY(-2px)}
.employee-header{display:flex;align-items:flex-start;gap:12px;margin-bottom:16px}
.employee-avatar{width:48px;height:48px;border-radius:var(--radius-md);background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));display:flex;align-items:center;justify-content:center;font-weight:700;font-size:16px;color:var(--bg-primary);flex-shrink:0}
.employee-details{flex:1;min-width:0}.employee-name{font-size:16px;font-weight:700;color:var(--text-primary);margin-bottom:2px}.employee-role{font-size:12px;color:var(--accent-primary);font-weight:600}
.employee-meta{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}.employee-meta-item{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--text-secondary)}.employee-meta-item svg{width:14px;height:14px;color:var(--text-muted)}
.employee-stats{display:flex;gap:12px;padding-top:16px;border-top:1px solid var(--border-subtle)}.employee-stat{flex:1;text-align:center}.employee-stat-value{font-size:20px;font-weight:700;color:var(--text-primary);font-family:var(--font-mono)}.employee-stat-label{font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted)}
.employee-actions{display:flex;gap:8px;margin-top:16px}.employee-actions .btn{flex:1}
.analytics-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:24px}.analytics-card{background:var(--bg-secondary);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);padding:24px}.analytics-card.full-width{grid-column:1/-1}
.analytics-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}.analytics-title{font-size:14px;font-weight:700;color:var(--text-primary)}
.chart-container{height:200px;display:flex;align-items:flex-end;gap:8px;padding-top:20px}
.chart-bar{flex:1;background:var(--accent-primary-dim);border-radius:4px 4px 0 0;position:relative;min-height:20px;transition:all .3s ease}.chart-bar:hover{background:var(--accent-primary)}
.chart-bar-label{position:absolute;bottom:-24px;left:50%;transform:translateX(-50%);font-size:10px;color:var(--text-muted);white-space:nowrap}
.chart-bar-value{position:absolute;top:-20px;left:50%;transform:translateX(-50%);font-size:11px;font-weight:600;color:var(--text-secondary);opacity:0;transition:opacity .15s ease}.chart-bar:hover .chart-bar-value{opacity:1}
.metrics-list{display:flex;flex-direction:column;gap:12px}.metric-item{display:flex;align-items:center;justify-content:space-between;padding:12px;background:var(--bg-tertiary);border-radius:var(--radius-md)}.metric-label{font-size:13px;color:var(--text-secondary)}.metric-value{font-size:14px;font-weight:700;color:var(--text-primary);font-family:var(--font-mono)}
.progress-bar{height:6px;background:var(--bg-hover);border-radius:3px;overflow:hidden;margin-top:8px}.progress-fill{height:100%;background:linear-gradient(90deg,var(--accent-primary),var(--accent-secondary));border-radius:3px;transition:width .5s ease}
.settings-layout{display:grid;grid-template-columns:240px 1fr;gap:32px}
.settings-nav{display:flex;flex-direction:column;gap:4px}
.settings-nav-item{display:flex;align-items:center;gap:12px;padding:10px 12px;border-radius:var(--radius-md);cursor:pointer;transition:all .15s ease;color:var(--text-secondary);font-size:14px;font-weight:500}
.settings-nav-item:hover{background:var(--bg-hover);color:var(--text-primary)}.settings-nav-item.active{background:var(--accent-primary-dim);color:var(--accent-primary)}.settings-nav-item svg{width:18px;height:18px}
.settings-panel{background:var(--bg-secondary);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);padding:24px}
.settings-section{margin-bottom:32px}.settings-section:last-child{margin-bottom:0}
.settings-section-title{font-size:16px;font-weight:700;color:var(--text-primary);margin-bottom:4px}.settings-section-desc{font-size:13px;color:var(--text-muted);margin-bottom:20px}
.setting-row{display:flex;align-items:center;justify-content:space-between;padding:16px 0;border-bottom:1px solid var(--border-subtle)}.setting-row:last-child{border-bottom:none}
.setting-info{flex:1}.setting-label{font-size:14px;font-weight:600;color:var(--text-primary);margin-bottom:2px}.setting-desc{font-size:12px;color:var(--text-muted)}
.toggle{position:relative;width:44px;height:24px}.toggle input{opacity:0;width:0;height:0}
.toggle-slider{position:absolute;cursor:pointer;inset:0;background:var(--bg-hover);border:1px solid var(--border-default);border-radius:12px;transition:all .2s ease}
.toggle-slider::before{content:'';position:absolute;height:18px;width:18px;left:2px;bottom:2px;background:var(--text-secondary);border-radius:50%;transition:all .2s ease}
.toggle input:checked+.toggle-slider{background:var(--accent-primary);border-color:var(--accent-primary)}.toggle input:checked+.toggle-slider::before{transform:translateX(20px);background:var(--bg-primary)}
.tasks-container{display:flex;flex-direction:column;gap:12px}
.task-item{display:flex;align-items:center;gap:12px;padding:16px;background:var(--bg-secondary);border:1px solid var(--border-subtle);border-radius:var(--radius-md);transition:all .15s ease}.task-item:hover{border-color:var(--border-default)}
.task-checkbox{width:20px;height:20px;border:2px solid var(--border-strong);border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s ease;flex-shrink:0}
.task-checkbox:hover{border-color:var(--accent-primary)}.task-checkbox.checked{background:var(--accent-primary);border-color:var(--accent-primary)}.task-checkbox.checked svg{color:var(--bg-primary)}.task-checkbox svg{width:12px;height:12px;color:transparent}
.task-content{flex:1;min-width:0}.task-title{font-size:14px;font-weight:500;color:var(--text-primary);margin-bottom:4px}.task-item.completed .task-title{text-decoration:line-through;color:var(--text-muted)}
.task-meta{display:flex;align-items:center;gap:12px;font-size:12px;color:var(--text-muted)}.task-due{display:flex;align-items:center;gap:4px}.task-due.overdue{color:var(--status-lost)}
.toast-container{position:fixed;bottom:24px;right:24px;z-index:300;display:flex;flex-direction:column;gap:8px}
.toast{display:flex;align-items:center;gap:12px;padding:14px 18px;background:var(--bg-secondary);border:1px solid var(--border-subtle);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);animation:toastSlide .3s ease;min-width:300px}
@keyframes toastSlide{from{opacity:0;transform:translateX(100%)}to{opacity:1;transform:translateX(0)}}
.toast-icon{width:20px;height:20px;flex-shrink:0}.toast.success .toast-icon{color:var(--accent-primary)}.toast.error .toast-icon{color:var(--status-lost)}.toast.warning .toast-icon{color:var(--status-pending)}
.toast-message{font-size:13px;color:var(--text-primary)}
.toast-close{margin-left:auto;width:20px;height:20px;display:flex;align-items:center;justify-content:center;background:transparent;border:none;color:var(--text-muted);cursor:pointer;border-radius:4px;transition:all .15s ease}.toast-close:hover{background:var(--bg-hover);color:var(--text-primary)}
@media(max-width:1024px){.analytics-grid{grid-template-columns:1fr}.settings-layout{grid-template-columns:1fr}.settings-nav{flex-direction:row;flex-wrap:wrap}}
@media(max-width:768px){.sidebar{transform:translateX(-100%);transition:transform .3s ease}.sidebar.active{transform:translateX(0)}.main-content{margin-left:0}.topbar{padding:0 20px}.content{padding:20px}.form-grid,.detail-grid{grid-template-columns:1fr}.stats-grid{grid-template-columns:repeat(2,1fr)}.controls-bar{flex-direction:column;align-items:stretch}.search-box{min-width:100%}}
    </style>
</head>
<body>
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header"><div class="logo"><div class="logo-mark">{ }</div><div class="logo-text">CraftedCode <span>CRM</span></div></div></div>
        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-title">Overview</div>
                <div class="nav-item active" data-section="dashboard"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>Dashboard</div>
                <div class="nav-item" data-section="analytics"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>Analytics</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Pipeline</div>
                <div class="nav-item" data-section="leads"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>All Leads<span class="nav-badge" id="leadsBadge">0</span></div>
                <div class="nav-item" data-section="new"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>New<span class="nav-badge" id="newBadge">0</span></div>
                <div class="nav-item" data-section="pending"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Pending<span class="nav-badge" id="pendingBadge">0</span></div>
                <div class="nav-item" data-section="contacted"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72"/></svg>Contacted</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Management</div>
                <div class="nav-item" data-section="customers"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>Customers<span class="nav-badge" id="customersBadge">0</span></div>
                <div class="nav-item" data-section="employees"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>Team</div>
                <div class="nav-item" data-section="tasks"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>Tasks</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">System</div>
                <div class="nav-item" data-section="settings"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>Settings</div>
            </div>
        </nav>
        <div class="sidebar-footer"><div class="user-card" onclick="logout()"><div class="user-avatar">AD</div><div class="user-info"><div class="user-name">Admin User</div><div class="user-role">Administrator</div></div><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color:var(--text-muted)"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg></div></div>
    </aside>
    <main class="main-content">
        <header class="topbar">
            <div class="page-header"><h1 class="page-title" id="pageTitle">Dashboard</h1></div>
            <div class="topbar-actions">
                <button class="btn btn-secondary" onclick="openExportModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>Export</button>
                <button class="btn btn-primary" onclick="openCreateModal('lead')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>Add Lead</button>
            </div>
        </header>
        <div class="content" id="contentArea"></div>
    </main>
    <div class="modal-overlay" id="detailModal"><div class="modal"><div class="modal-header"><h2 class="modal-title" id="detailModalTitle">Lead Details</h2><button class="modal-close" onclick="closeDetailModal()"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><div class="modal-body" id="detailModalBody"></div><div class="modal-footer" id="detailModalFooter"></div></div></div>
    <div class="modal-overlay" id="createModal"><div class="modal"><div class="modal-header"><h2 class="modal-title" id="createModalTitle">Create Lead</h2><button class="modal-close" onclick="closeCreateModal()"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><div class="modal-body" id="createModalBody"></div></div></div>
    <div class="toast-container" id="toastContainer"></div>
    <script>
const API_URL=window.location.origin;let authToken=localStorage.getItem('adminToken')||sessionStorage.getItem('adminToken');
const state={leads:[],customers:[],employees:[],tasks:[],currentSection:'dashboard',currentFilter:'all',currentLead:null,searchQuery:'',settings:{emailNotifications:true,pushNotifications:false,darkMode:true,autoAssign:false,weeklyReport:true}};
document.addEventListener('DOMContentLoaded',async function(){if(!authToken){window.location.href='/admin';return}try{const r=await fetch(`${API_URL}/api/admin/verify`,{method:'POST',headers:{'Authorization':`Bearer ${authToken}`}});if(!r.ok){localStorage.removeItem('adminToken');sessionStorage.removeItem('adminToken');window.location.href='/admin';return}}catch(e){console.error('Token verification failed:',e);window.location.href='/admin';return}await loadAllData();setupNavigation();renderSection('dashboard')});
async function loadAllData(){await Promise.all([loadLeads(),loadEmployees(),loadTasks()]);updateBadges()}
async function loadLeads(){try{const r=await fetch(`${API_URL}/api/leads`,{headers:{'Authorization':`Bearer ${authToken}`}});if(r.status===401||r.status===403){logout();return}const d=await r.json();if(d.success){state.leads=(d.leads||[]).filter(l=>!l.is_customer);state.customers=(d.leads||[]).filter(l=>l.is_customer)}}catch(e){console.error('Error loading leads:',e)}}
async function loadEmployees(){try{const r=await fetch(`${API_URL}/api/employees`,{headers:{'Authorization':`Bearer ${authToken}`}});if(!r.ok)return;const d=await r.json();if(d.success){state.employees=d.employees||[]}}catch(e){console.error('Error loading employees:',e)}}
async function loadTasks(){state.tasks=[{id:1,title:'Follow up with new leads',dueDate:'2026-01-20',assignee:'Admin',completed:false,priority:'high'},{id:2,title:'Prepare weekly report',dueDate:'2026-01-22',assignee:'Admin',completed:false,priority:'medium'},{id:3,title:'Review contract terms',dueDate:'2026-01-18',assignee:'Admin',completed:true,priority:'low'},{id:4,title:'Schedule team meeting',dueDate:'2026-01-25',assignee:'Admin',completed:false,priority:'medium'}]}
function updateBadges(){const n=state.leads.filter(l=>l.status==='new').length;const p=state.leads.filter(l=>l.status==='pending').length;document.getElementById('leadsBadge').textContent=state.leads.length;document.getElementById('newBadge').textContent=n;document.getElementById('pendingBadge').textContent=p;document.getElementById('customersBadge').textContent=state.customers.length}
function setupNavigation(){document.querySelectorAll('.nav-item').forEach(item=>{item.addEventListener('click',function(){const s=this.dataset.section;if(s){document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('active'));this.classList.add('active');renderSection(s)}})})}
function renderSection(section){state.currentSection=section;state.currentFilter='all';const titles={dashboard:'Dashboard',analytics:'Analytics',leads:'All Leads',new:'New Leads',pending:'Pending Leads',contacted:'Contacted Leads',customers:'Customers',employees:'Team Management',tasks:'Tasks',settings:'Settings'};document.getElementById('pageTitle').textContent=titles[section]||'Dashboard';const content=document.getElementById('contentArea');switch(section){case'dashboard':renderDashboard(content);break;case'analytics':renderAnalytics(content);break;case'leads':case'new':case'pending':case'contacted':state.currentFilter=section==='leads'?'all':section;renderLeadsTable(content,'leads');break;case'customers':renderLeadsTable(content,'customers');break;case'employees':renderEmployees(content);break;case'tasks':renderTasks(content);break;case'settings':renderSettings(content);break}}
function renderDashboard(c){const n=state.leads.filter(l=>l.status==='new').length;const p=state.leads.filter(l=>l.status==='pending').length;const ct=state.leads.filter(l=>l.status==='contacted').length;const ac=state.customers.filter(x=>!['completed','churned','cancelled'].includes(x.customer_status)).length;const cr=state.leads.length>0?Math.round((state.customers.length/(state.leads.length+state.customers.length))*100):0;c.innerHTML=`<div class="stats-grid"><div class="stat-card"><div class="stat-header"><span class="stat-label">New Leads</span><div class="stat-icon blue"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg></div></div><div class="stat-value">${n}</div><div class="stat-change positive">Requires attention</div></div><div class="stat-card"><div class="stat-header"><span class="stat-label">Pending</span><div class="stat-icon amber"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg></div></div><div class="stat-value">${p}</div><div class="stat-change">In progress</div></div><div class="stat-card"><div class="stat-header"><span class="stat-label">Contacted</span><div class="stat-icon green"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07"/></svg></div></div><div class="stat-value">${ct}</div><div class="stat-change positive">Active follow-up</div></div><div class="stat-card"><div class="stat-header"><span class="stat-label">Total Leads</span><div class="stat-icon purple"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg></div></div><div class="stat-value">${state.leads.length}</div><div class="stat-change">Pipeline total</div></div><div class="stat-card"><div class="stat-header"><span class="stat-label">Active Customers</span><div class="stat-icon green"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></div></div><div class="stat-value">${ac}</div><div class="stat-change positive">Converting</div></div><div class="stat-card"><div class="stat-header"><span class="stat-label">Conversion Rate</span><div class="stat-icon green"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/></svg></div></div><div class="stat-value">${cr}%</div><div class="stat-change positive">Lead to customer</div></div></div><div class="controls-bar"><div class="search-box"><svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><input type="text" class="search-input" placeholder="Search leads by name, email, or phone..." id="searchInput" oninput="handleSearch(this.value)"></div><div class="filter-group" id="filterGroup"><button class="filter-btn active" data-filter="all">All</button><button class="filter-btn" data-filter="new">New</button><button class="filter-btn" data-filter="pending">Pending</button><button class="filter-btn" data-filter="contacted">Contacted</button><button class="filter-btn" data-filter="lost">Lost</button></div></div><div class="table-container"><table class="data-table"><thead><tr><th>Contact</th><th>Phone</th><th>Service</th><th>Budget</th><th>Date</th><th>Status</th><th>Priority</th><th>Assigned</th><th>Actions</th></tr></thead><tbody id="tableBody"></tbody></table><div class="table-footer"><div class="table-info" id="tableInfo">Showing 0 leads</div><div class="pagination" id="pagination"></div></div></div>`;setupFilterButtons();renderTableData('leads')}
function renderLeadsTable(c,type){const isC=type==='customers';const filters=isC?[{key:'all',label:'All'},{key:'onboarding',label:'Onboarding'},{key:'in-progress',label:'In Progress'},{key:'review',label:'Review'},{key:'completed',label:'Completed'},{key:'on-hold',label:'On Hold'}]:[{key:'all',label:'All'},{key:'new',label:'New'},{key:'pending',label:'Pending'},{key:'contacted',label:'Contacted'},{key:'lost',label:'Lost'}];c.innerHTML=`<div class="controls-bar"><div class="search-box"><svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><input type="text" class="search-input" placeholder="Search by name, email, or phone..." id="searchInput" oninput="handleSearch(this.value)"></div><div class="filter-group" id="filterGroup">${filters.map(f=>`<button class="filter-btn ${f.key===state.currentFilter||(state.currentFilter==='all'&&f.key==='all')?'active':''}" data-filter="${f.key}">${f.label}</button>`).join('')}</div>${isC?'<button class="btn btn-primary" onclick="openCreateModal(\'customer\')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>Add Customer</button>':''}</div><div class="table-container"><table class="data-table"><thead><tr><th>Contact</th><th>Phone</th><th>Service</th><th>Budget</th><th>Date</th><th>Status</th><th>Priority</th><th>Assigned</th><th>Actions</th></tr></thead><tbody id="tableBody"></tbody></table><div class="table-footer"><div class="table-info" id="tableInfo">Showing 0 items</div><div class="pagination" id="pagination"></div></div></div>`;setupFilterButtons();renderTableData(type)}
function setupFilterButtons(){document.querySelectorAll('.filter-btn').forEach(btn=>{btn.addEventListener('click',function(){document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');state.currentFilter=this.dataset.filter;renderTableData(state.currentSection==='customers'?'customers':'leads')})})}
function handleSearch(q){state.searchQuery=q.toLowerCase();renderTableData(state.currentSection==='customers'?'customers':'leads')}
function renderTableData(type){const tbody=document.getElementById('tableBody');if(!tbody)return;const isC=type==='customers';let data=isC?[...state.customers]:[...state.leads];if(state.currentFilter!=='all'){if(isC){data=data.filter(i=>(i.customer_status||'onboarding')===state.currentFilter)}else{data=data.filter(i=>i.status===state.currentFilter)}}if(state.searchQuery){data=data.filter(i=>(i.first_name||'').toLowerCase().includes(state.searchQuery)||(i.last_name||'').toLowerCase().includes(state.searchQuery)||(i.email||'').toLowerCase().includes(state.searchQuery)||(i.phone&&String(i.phone).includes(state.searchQuery)))}data.sort((a,b)=>new Date(b.created_at)-new Date(a.created_at));if(data.length===0){tbody.innerHTML=`<tr><td colspan="9"><div class="empty-state"><svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="17" y1="11" x2="23" y2="11"/></svg><div class="empty-title">No ${isC?'customers':'leads'} found</div><div class="empty-description">Try adjusting your search or filters.</div></div></td></tr>`}else{tbody.innerHTML=data.map(i=>{const init=((i.first_name||'')[0]||'')+((i.last_name||'')[0]||'');const emp=state.employees.find(e=>e.id===i.assigned_to);const st=isC?(i.customer_status||'onboarding'):i.status;return`<tr onclick="openDetailModal(${i.id})"><td><div class="contact-cell"><div class="contact-avatar">${init.toUpperCase()}</div><div class="contact-info"><div class="contact-name">${i.first_name||''} ${i.last_name||''}</div><div class="contact-email">${i.email||''}</div></div></div></td><td>${i.phone||'-'}</td><td>${i.service||'-'}</td><td>${i.budget||'-'}</td><td>${formatDate(i.created_at)}</td><td><span class="status-badge status-${st}"><span class="status-dot"></span>${st.replace('-',' ')}</span></td><td><span class="priority-badge priority-${i.priority||'medium'}">${i.priority||'medium'}</span></td><td>${emp?`${emp.first_name} ${emp.last_name}`:'<span style="color:var(--text-muted)">Unassigned</span>'}</td><td onclick="event.stopPropagation()"><div class="table-actions"><button class="table-action-btn" onclick="openDetailModal(${i.id})" title="View"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button><button class="table-action-btn danger" onclick="deleteLead(${i.id})" title="Delete"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button></div></td></tr>`}).join('')}document.getElementById('tableInfo').textContent=`Showing ${data.length} ${isC?'customers':'leads'}`}
function renderAnalytics(c){const md=[{month:'Aug',leads:12},{month:'Sep',leads:18},{month:'Oct',leads:24},{month:'Nov',leads:21},{month:'Dec',leads:28},{month:'Jan',leads:state.leads.length}];const ml=Math.max(...md.map(d=>d.leads),1);const tr=state.customers.reduce((s,x)=>{const b=parseFloat((x.budget||'').replace(/[^0-9.]/g,''))||0;return s+b},0);const ads=state.customers.length>0?tr/state.customers.length:0;const cr=(state.leads.length+state.customers.length)>0?((state.customers.length/(state.leads.length+state.customers.length))*100).toFixed(1):0;const sb={new:state.leads.filter(l=>l.status==='new').length,pending:state.leads.filter(l=>l.status==='pending').length,contacted:state.leads.filter(l=>l.status==='contacted').length,lost:state.leads.filter(l=>l.status==='lost').length};c.innerHTML=`<div class="analytics-grid"><div class="analytics-card full-width"><div class="analytics-header"><h3 class="analytics-title">Lead Acquisition Trend</h3><div class="filter-group"><button class="filter-btn active">6 Months</button><button class="filter-btn">1 Year</button></div></div><div class="chart-container">${md.map(d=>`<div class="chart-bar" style="height:${(d.leads/ml)*100}%"><span class="chart-bar-value">${d.leads}</span><span class="chart-bar-label">${d.month}</span></div>`).join('')}</div></div><div class="analytics-card"><div class="analytics-header"><h3 class="analytics-title">Key Metrics</h3></div><div class="metrics-list"><div class="metric-item"><span class="metric-label">Total Revenue</span><span class="metric-value">$${tr.toLocaleString()}</span></div><div class="metric-item"><span class="metric-label">Average Deal Size</span><span class="metric-value">$${ads.toLocaleString(undefined,{maximumFractionDigits:0})}</span></div><div class="metric-item"><span class="metric-label">Conversion Rate</span><span class="metric-value">${cr}%</span></div><div class="metric-item"><span class="metric-label">Active Pipeline</span><span class="metric-value">${state.leads.length}</span></div></div></div><div class="analytics-card"><div class="analytics-header"><h3 class="analytics-title">Pipeline Breakdown</h3></div><div class="metrics-list"><div class="metric-item"><span class="metric-label">New Leads</span><span class="metric-value">${sb.new}</span></div><div class="progress-bar"><div class="progress-fill" style="width:${state.leads.length>0?(sb.new/state.leads.length)*100:0}%"></div></div><div class="metric-item"><span class="metric-label">Pending</span><span class="metric-value">${sb.pending}</span></div><div class="progress-bar"><div class="progress-fill" style="width:${state.leads.length>0?(sb.pending/state.leads.length)*100:0}%"></div></div><div class="metric-item"><span class="metric-label">Contacted</span><span class="metric-value">${sb.contacted}</span></div><div class="progress-bar"><div class="progress-fill" style="width:${state.leads.length>0?(sb.contacted/state.leads.length)*100:0}%"></div></div><div class="metric-item"><span class="metric-label">Lost</span><span class="metric-value">${sb.lost}</span></div><div class="progress-bar"><div class="progress-fill" style="width:${state.leads.length>0?(sb.lost/state.leads.length)*100:0}%;background:var(--status-lost)"></div></div></div></div><div class="analytics-card"><div class="analytics-header"><h3 class="analytics-title">Team Performance</h3></div><div class="metrics-list">${state.employees.length>0?state.employees.map(emp=>{const al=state.leads.filter(l=>l.assigned_to===emp.id).length;const ac=state.customers.filter(x=>x.assigned_to===emp.id).length;return`<div class="metric-item"><span class="metric-label">${emp.first_name} ${emp.last_name}</span><span class="metric-value">${al+ac} assigned</span></div>`}).join(''):'<div class="metric-item"><span class="metric-label">No team members yet</span></div>'}</div></div></div>`}
function renderEmployees(c){c.innerHTML=`<div class="controls-bar"><div class="search-box"><svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><input type="text" class="search-input" placeholder="Search team members..." id="employeeSearch" oninput="filterEmployees(this.value)"></div><button class="btn btn-primary" onclick="openEmployeeModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>Add Team Member</button></div><div class="cards-grid" id="employeesGrid">${state.employees.length>0?state.employees.map(emp=>renderEmployeeCard(emp)).join(''):`<div class="empty-state" style="grid-column:1/-1"><svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg><div class="empty-title">No team members yet</div><div class="empty-description">Add your first team member to start assigning leads.</div></div>`}</div>`}
function renderEmployeeCard(emp){const init=((emp.first_name||'')[0]||'')+((emp.last_name||'')[0]||'');const al=state.leads.filter(l=>l.assigned_to===emp.id).length;const ac=state.customers.filter(x=>x.assigned_to===emp.id).length;return`<div class="employee-card"><div class="employee-header"><div class="employee-avatar">${init.toUpperCase()}</div><div class="employee-details"><div class="employee-name">${emp.first_name} ${emp.last_name}</div><div class="employee-role">${emp.role||'Team Member'}</div></div></div><div class="employee-meta"><div class="employee-meta-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>${emp.email}</div>${emp.phone?`<div class="employee-meta-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07"/></svg>${emp.phone}</div>`:''}</div><div class="employee-stats"><div class="employee-stat"><div class="employee-stat-value">${al}</div><div class="employee-stat-label">Leads</div></div><div class="employee-stat"><div class="employee-stat-value">${ac}</div><div class="employee-stat-label">Customers</div></div><div class="employee-stat"><div class="employee-stat-value">${al+ac}</div><div class="employee-stat-label">Total</div></div></div><div class="employee-actions"><button class="btn btn-secondary" onclick="openEmployeeModal(${emp.id})">Edit</button><button class="btn btn-danger" onclick="deleteEmployee(${emp.id})">Remove</button></div></div>`}
function filterEmployees(q){const grid=document.getElementById('employeesGrid');if(!grid)return;const f=state.employees.filter(emp=>(emp.first_name||'').toLowerCase().includes(q.toLowerCase())||(emp.last_name||'').toLowerCase().includes(q.toLowerCase())||(emp.email||'').toLowerCase().includes(q.toLowerCase()));grid.innerHTML=f.length>0?f.map(emp=>renderEmployeeCard(emp)).join(''):`<div class="empty-state" style="grid-column:1/-1"><div class="empty-title">No matches found</div><div class="empty-description">Try a different search term.</div></div>`}
function renderTasks(c){const pt=state.tasks.filter(t=>!t.completed);const ct=state.tasks.filter(t=>t.completed);c.innerHTML=`<div class="controls-bar"><div class="search-box"><svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><input type="text" class="search-input" placeholder="Search tasks..." id="taskSearch"></div><button class="btn btn-primary" onclick="openTaskModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>Add Task</button></div><div class="detail-section"><div class="section-header"><h3 class="section-title">Pending Tasks (${pt.length})</h3></div><div class="tasks-container" id="pendingTasks">${pt.length>0?pt.map(t=>renderTaskItem(t)).join(''):`<div class="empty-state"><div class="empty-title">All caught up!</div><div class="empty-description">No pending tasks.</div></div>`}</div></div><div class="detail-section"><div class="section-header"><h3 class="section-title">Completed (${ct.length})</h3></div><div class="tasks-container" id="completedTasks">${ct.length>0?ct.map(t=>renderTaskItem(t)).join(''):`<div class="empty-state"><div class="empty-title">No completed tasks</div><div class="empty-description">Complete tasks to see them here.</div></div>`}</div></div>`}
function renderTaskItem(t){const od=!t.completed&&new Date(t.dueDate)<new Date();return`<div class="task-item ${t.completed?'completed':''}"><div class="task-checkbox ${t.completed?'checked':''}" onclick="toggleTask(${t.id})"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg></div><div class="task-content"><div class="task-title">${t.title}</div><div class="task-meta"><span class="task-due ${od?'overdue':''}"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>${formatDate(t.dueDate)}</span><span class="priority-badge priority-${t.priority}">${t.priority}</span></div></div><div class="table-actions"><button class="table-action-btn" onclick="editTask(${t.id})" title="Edit"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg></button><button class="table-action-btn danger" onclick="deleteTask(${t.id})" title="Delete"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button></div></div>`}
function toggleTask(id){const t=state.tasks.find(x=>x.id===id);if(t){t.completed=!t.completed;renderTasks(document.getElementById('contentArea'));showToast(t.completed?'Task completed':'Task reopened','success')}}
function deleteTask(id){if(confirm('Delete this task?')){state.tasks=state.tasks.filter(t=>t.id!==id);renderTasks(document.getElementById('contentArea'));showToast('Task deleted','success')}}
function renderSettings(c){c.innerHTML=`<div class="settings-layout"><div class="settings-nav"><div class="settings-nav-item active" data-panel="general"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33"/></svg>General</div><div class="settings-nav-item" data-panel="notifications"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>Notifications</div><div class="settings-nav-item" data-panel="security"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>Security</div></div><div class="settings-panel" id="settingsPanel"><div class="settings-section"><h3 class="settings-section-title">General Settings</h3><p class="settings-section-desc">Manage your account preferences and CRM configuration.</p><div class="setting-row"><div class="setting-info"><div class="setting-label">Dark Mode</div><div class="setting-desc">Use dark theme across the application</div></div><label class="toggle"><input type="checkbox" ${state.settings.darkMode?'checked':''} onchange="updateSetting('darkMode',this.checked)"><span class="toggle-slider"></span></label></div><div class="setting-row"><div class="setting-info"><div class="setting-label">Auto-assign Leads</div><div class="setting-desc">Automatically assign new leads to team members</div></div><label class="toggle"><input type="checkbox" ${state.settings.autoAssign?'checked':''} onchange="updateSetting('autoAssign',this.checked)"><span class="toggle-slider"></span></label></div></div><div class="settings-section"><h3 class="settings-section-title">Notifications</h3><p class="settings-section-desc">Configure how you receive notifications.</p><div class="setting-row"><div class="setting-info"><div class="setting-label">Email Notifications</div><div class="setting-desc">Receive email updates for new leads and activities</div></div><label class="toggle"><input type="checkbox" ${state.settings.emailNotifications?'checked':''} onchange="updateSetting('emailNotifications',this.checked)"><span class="toggle-slider"></span></label></div><div class="setting-row"><div class="setting-info"><div class="setting-label">Weekly Report</div><div class="setting-desc">Receive weekly summary reports via email</div></div><label class="toggle"><input type="checkbox" ${state.settings.weeklyReport?'checked':''} onchange="updateSetting('weeklyReport',this.checked)"><span class="toggle-slider"></span></label></div></div><div class="settings-section"><h3 class="settings-section-title">Data Management</h3><p class="settings-section-desc">Export or manage your CRM data.</p><div style="display:flex;gap:12px;margin-top:16px"><button class="btn btn-secondary" onclick="exportData('csv')">Export to CSV</button><button class="btn btn-secondary" onclick="exportData('json')">Export to JSON</button></div></div></div></div>`}
function updateSetting(k,v){state.settings[k]=v;showToast('Settings updated','success')}
function openEmployeeModal(id=null){const isE=!!id;let emp=null;if(isE){emp=state.employees.find(e=>e.id===id);if(!emp)return}document.getElementById('createModalTitle').textContent=`${isE?'Edit':'Add'} Team Member`;document.getElementById('createModalBody').innerHTML=`<form id="employeeForm" onsubmit="saveEmployee(event,${isE?id:'null'})"><div class="form-grid"><div class="form-group"><label class="form-label">First Name <span class="required">*</span></label><input type="text" class="form-input" id="empFirstName" value="${emp?.first_name||''}" required></div><div class="form-group"><label class="form-label">Last Name <span class="required">*</span></label><input type="text" class="form-input" id="empLastName" value="${emp?.last_name||''}" required></div><div class="form-group"><label class="form-label">Email <span class="required">*</span></label><input type="email" class="form-input" id="empEmail" value="${emp?.email||''}" required></div><div class="form-group"><label class="form-label">Phone</label><input type="tel" class="form-input" id="empPhone" value="${emp?.phone||''}"></div><div class="form-group full-width"><label class="form-label">Role</label><input type="text" class="form-input" id="empRole" value="${emp?.role||''}" placeholder="e.g., Sales Manager, Developer"></div></div><div style="display:flex;justify-content:flex-end;gap:12px;margin-top:24px"><button type="button" class="btn btn-secondary" onclick="closeCreateModal()">Cancel</button><button type="submit" class="btn btn-primary">${isE?'Update':'Add'} Member</button></div></form>`;document.getElementById('createModal').classList.add('active');document.body.style.overflow='hidden'}
async function saveEmployee(e,id){e.preventDefault();const ed={firstName:document.getElementById('empFirstName').value.trim(),lastName:document.getElementById('empLastName').value.trim(),email:document.getElementById('empEmail').value.trim(),phone:document.getElementById('empPhone').value.trim(),role:document.getElementById('empRole').value.trim()};try{const url=id?`${API_URL}/api/employees/${id}`:`${API_URL}/api/employees`;const method=id?'PATCH':'POST';const r=await fetch(url,{method:method,headers:{'Content-Type':'application/json','Authorization':`Bearer ${authToken}`},body:JSON.stringify(ed)});const d=await r.json();if(d.success){await loadEmployees();closeCreateModal();renderSection('employees');showToast(`Team member ${id?'updated':'added'} successfully`,'success')}else{showToast(d.message||'Error saving employee','error')}}catch(err){console.error('Save employee error:',err);showToast('Error saving employee','error')}}
async function deleteEmployee(id){if(!confirm('Are you sure you want to remove this team member?'))return;try{const r=await fetch(`${API_URL}/api/employees/${id}`,{method:'DELETE',headers:{'Authorization':`Bearer ${authToken}`}});const d=await r.json();if(d.success){await loadEmployees();renderSection('employees');showToast('Team member removed','success')}else{showToast(d.message||'Error removing employee','error')}}catch(err){console.error('Delete employee error:',err);showToast('Error removing employee','error')}}
function openTaskModal(id=null){const isE=!!id;let t=null;if(isE){t=state.tasks.find(x=>x.id===id);if(!t)return}document.getElementById('createModalTitle').textContent=`${isE?'Edit':'Add'} Task`;document.getElementById('createModalBody').innerHTML=`<form id="taskForm" onsubmit="saveTask(event,${isE?id:'null'})"><div class="form-grid"><div class="form-group full-width"><label class="form-label">Task Title <span class="required">*</span></label><input type="text" class="form-input" id="taskTitle" value="${t?.title||''}" required></div><div class="form-group"><label class="form-label">Due Date</label><input type="date" class="form-input" id="taskDueDate" value="${t?.dueDate||''}"></div><div class="form-group"><label class="form-label">Priority</label><select class="form-select" id="taskPriority"><option value="low" ${t?.priority==='low'?'selected':''}>Low</option><option value="medium" ${t?.priority==='medium'||!t?'selected':''}>Medium</option><option value="high" ${t?.priority==='high'?'selected':''}>High</option></select></div></div><div style="display:flex;justify-content:flex-end;gap:12px;margin-top:24px"><button type="button" class="btn btn-secondary" onclick="closeCreateModal()">Cancel</button><button type="submit" class="btn btn-primary">${isE?'Update':'Add'} Task</button></div></form>`;document.getElementById('createModal').classList.add('active');document.body.style.overflow='hidden'}
function saveTask(e,id){e.preventDefault();const td={id:id||Date.now(),title:document.getElementById('taskTitle').value.trim(),dueDate:document.getElementById('taskDueDate').value,priority:document.getElementById('taskPriority').value,assignee:'Admin',completed:id?state.tasks.find(t=>t.id===id)?.completed||false:false};if(id){const idx=state.tasks.findIndex(t=>t.id===id);if(idx!==-1)state.tasks[idx]=td}else{state.tasks.push(td)}closeCreateModal();renderSection('tasks');showToast(`Task ${id?'updated':'created'}`,'success')}
function editTask(id){openTaskModal(id)}
async function updateStatus(){if(!state.currentLead)return;const ns=document.getElementById('modalStatus').value;const isC=state.currentLead.is_customer;if(!isC&&ns==='closed'){if(!confirm('This will convert the lead to a customer. Continue?')){document.getElementById('modalStatus').value=state.currentLead.status;return}}try{const ep=isC?`${API_URL}/api/leads/${state.currentLead.id}/customer-status`:`${API_URL}/api/leads/${state.currentLead.id}/status`;const body=isC?{customerStatus:ns}:{status:ns,isCustomer:ns==='closed',customerStatus:ns==='closed'?'onboarding':null};const r=await fetch(ep,{method:'PATCH',headers:{'Content-Type':'application/json','Authorization':`Bearer ${authToken}`},body:JSON.stringify(body)});const d=await r.json();if(d.success){await loadLeads();updateBadges();if(!isC&&ns==='closed'){closeDetailModal();showToast('Lead converted to customer','success')}else{showToast('Status updated','success')}renderSection(state.currentSection)}}catch(err){console.error('Error updating status:',err);showToast('Error updating status','error')}}
async function updatePriority(){if(!state.currentLead)return;const np=document.getElementById('modalPriority').value;try{const r=await fetch(`${API_URL}/api/leads/${state.currentLead.id}/priority`,{method:'PATCH',headers:{'Content-Type':'application/json','Authorization':`Bearer ${authToken}`},body:JSON.stringify({priority:np})});const d=await r.json();if(d.success){await loadLeads();showToast('Priority updated','success');renderSection(state.currentSection)}}catch(err){console.error('Error updating priority:',err);showToast('Error updating priority','error')}}
async function updateAssignment(){if(!state.currentLead)return;const eid=document.getElementById('modalAssignment').value;try{const r=await fetch(`${API_URL}/api/leads/${state.currentLead.id}/assign`,{method:'PATCH',headers:{'Content-Type':'application/json','Authorization':`Bearer ${authToken}`},body:JSON.stringify({employeeId:eid||null})});const d=await r.json();if(d.success){await loadLeads();showToast('Assignment updated','success');renderSection(state.currentSection)}}catch(err){console.error('Error updating assignment:',err);showToast('Error updating assignment','error')}}
async function addNote(){if(!state.currentLead)return;const nt=document.getElementById('newNoteText').value.trim();if(!nt){showToast('Please enter a note','warning');return}try{const r=await fetch(`${API_URL}/api/leads/${state.currentLead.id}/notes`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${authToken}`},body:JSON.stringify({noteText:nt})});const d=await r.json();if(d.success){document.getElementById('newNoteText').value='';await openDetailModal(state.currentLead.id);showToast('Note added','success')}}catch(err){console.error('Error adding note:',err);showToast('Error adding note','error')}}
async function deleteLead(id){if(!confirm('Are you sure you want to permanently delete this record? This action cannot be undone.'))return;try{const r=await fetch(`${API_URL}/api/leads/${id}`,{method:'DELETE',headers:{'Authorization':`Bearer ${authToken}`}});const d=await r.json();if(d.success){await loadLeads();updateBadges();closeDetailModal();renderSection(state.currentSection);showToast('Record deleted','success')}else{showToast(d.error||'Error deleting record','error')}}catch(err){console.error('Error deleting:',err);showToast('Error deleting record','error')}}
function formatDate(ds){if(!ds)return'-';const d=new Date(ds);return d.toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'})}
function showToast(msg,type='success'){const c=document.getElementById('toastContainer');const t=document.createElement('div');t.className=`toast ${type}`;const icons={success:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>',error:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>',warning:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>'};t.innerHTML=`<span class="toast-icon">${icons[type]}</span><span class="toast-message">${msg}</span><button class="toast-close" onclick="this.parentElement.remove()"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>`;c.appendChild(t);setTimeout(()=>{t.remove()},4000)}
function exportData(fmt){const all=[...state.leads,...state.customers];if(fmt==='json'){const blob=new Blob([JSON.stringify(all,null,2)],{type:'application/json'});downloadBlob(blob,'crm-export.json')}else if(fmt==='csv'){const h=['First Name','Last Name','Email','Phone','Service','Budget','Status','Priority','Date'];const rows=all.map(i=>[i.first_name||'',i.last_name||'',i.email||'',i.phone||'',i.service||'',i.budget||'',i.is_customer?(i.customer_status||'onboarding'):i.status,i.priority||'',formatDate(i.created_at)]);const csv=[h,...rows].map(r=>r.map(c=>`"${c}"`).join(',')).join('\n');const blob=new Blob([csv],{type:'text/csv'});downloadBlob(blob,'crm-export.csv')}showToast(`Data exported as ${fmt.toUpperCase()}`,'success')}
function downloadBlob(blob,fn){const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=fn;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url)}
function openExportModal(){document.getElementById('createModalTitle').textContent='Export Data';document.getElementById('createModalBody').innerHTML=`<div class="detail-section"><p style="color:var(--text-secondary);margin-bottom:24px">Export your CRM data in your preferred format. All leads and customers will be included.</p><div style="display:flex;gap:12px"><button class="btn btn-primary" onclick="exportData('csv');closeCreateModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>Export CSV</button><button class="btn btn-secondary" onclick="exportData('json');closeCreateModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>Export JSON</button></div></div>`;document.getElementById('createModal').classList.add('active')}
function logout(){if(confirm('Are you sure you want to logout?')){localStorage.removeItem('adminToken');sessionStorage.removeItem('adminToken');window.location.replace('/admin')}}
document.getElementById('detailModal').addEventListener('click',function(e){if(e.target===this)closeDetailModal()});
document.getElementById('createModal').addEventListener('click',function(e){if(e.target===this)closeCreateModal()});
document.addEventListener('keydown',function(e){if(e.key==='Escape'){closeDetailModal();closeCreateModal()}});
    </script>
</body>
</html>